<!DOCTYPE html><html><head><meta charset="utf-8"><title>正则表达式入门 | LOVAE BLOG</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="John Doe"><meta name="designer" content="minfive"><meta name="keywords" content="lovae, shichao blog, 前端博客, 前端, 程序员, 前端开发, 全栈开发, node.js, javascript"><meta name="description" content="日常学习与兴趣交流的个人博客"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="all"><link rel="canonical" href="http://yoursite.com/2018/03/13/正则表达式入门/index.html"><link rel="icon" type="image/png" href="http://oo12ugek5.bkt.clouddn.com/blog/images/favicon.ico" sizes="32x32"><link rel="stylesheet" href="/scss/base/index.css"><link rel="alternate" href="/atom.xml" title="Hexo"><link rel="stylesheet" href="/scss/views/page/post.css"></head><body ontouchstart><div id="page-loading" class="page page-loading" style="background-image:url(http://oo12ugek5.bkt.clouddn.com/blog/images/loader.gif)"></div><div id="page" class="page js-hidden"><header class="page__small-header page__header--small"><nav class="page__navbar"><div class="page__container navbar-container"><a class="page__logo" href="/" title="Hexo" alt="Hexo"><img src="http://oo12ugek5.bkt.clouddn.com/images/logo-text-white.png" alt="Hexo"></a><nav class="page__nav"><ul class="nav__list clearfix"><li class="nav__item"><a href="/" alt="Home" title="Home">Home</a></li><li class="nav__item"><a href="/archives" alt="Archive" title="Archive">Archive</a></li><li class="nav__item"><a href="/demo" alt="Works" title="Works">Works</a></li><li class="nav__item"><a href="/music" alt="Music" title="Music">Music</a></li><li class="nav__item"><a href="/about" alt="About" title="About">About</a></li></ul></nav><button class="page__menu-btn" type="button"><i class="iconfont icon-menu"></i></button></div></nav></header><main class="page__container page__main"><div class="page__content"><article class="page__post"><div class="post__cover"><img src="https://tse3-mm.cn.bing.net/th?id=OIP.5HaX26pF6-WOmiKfHtTWkgHaEK&w=290&h=162&c=7&o=5&pid=1.7" alt="正则表达式入门"></div><header class="post__info"><h1 class="post__title">正则表达式入门</h1><div class="post__mark"><div class="mark__block"><i class="mark__icon iconfont icon-write"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/">Lovae</a></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-time"></i><ul class="mark__list clearfix"><li class="mark__item"><span>2018-03-13</span></li></ul></div><div class="mark__block"><i class="mark__icon iconfont icon-tab"></i><ul class="mark__list clearfix"><li class="mark__item"><a href="/tags/regex/">Regex</a></li></ul></div></div></header><div class="post__content"><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p><img src="http://upload-images.jianshu.io/upload_images/2463524-dcbd871af2bc547d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2" alt=""></p><h4 id="正则引擎"><a href="#正则引擎" class="headerlink" title="正则引擎"></a>正则引擎</h4><blockquote><p>为什么正则能有效，因为有引擎，这和为什么JS能执行一样，有JS引擎</p></blockquote><p>正则的引擎大致可分为两类：DFA和NFA</p><ul><li>DFA (Deterministic finite automaton) 确定型有穷自动机</li><li>NFA (Non-deterministic finite automaton) 非确定型有穷自动机，大部分都是NFA</li></ul><p>这里的“确定型”指，对于某个确定字符的输入，这台机器的状态会确定地从a跳到b，“非确定型”指，对于某个确定字符的输入，这台机器可能有好几种状态的跳法；这里的“有穷”指，状态是有限的，可以在有限的步数内确定某个字符串是被接受还是发好人卡的；这里的“自动机”，可以理解为，一旦这台机器的规则设定完成，就可以自行判断了，不要人看。</p><h4 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h4><p><img src="http://upload-images.jianshu.io/upload_images/2463524-8ddaddee044d96fd.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><blockquote><p>正则眼中的字符串——n个字符，n+1个位置</p><p>为什么要有字符还要有位置呢？因为位置是可以被匹配的。</p></blockquote><p>“占有字符”和“零宽度”:</p><ul><li>如果一个子正则表达式匹配到的是字符，而不是位置，而且会被保存到最终的结果中，那个这个子表达式就是占有字符的，比如 /ha/ （匹配 ha ）就是占有字符的；</li><li>如果一个子正则匹配的是位置，而不是字符，或者匹配到的内容不保存在结果中（其实也可以看做一个位置），那么这个子表达式是零宽度的，比如 /read(?=ing)/ （匹配 reading ，但是只将read放入结果中，下文会详述语法，此处仅仅举例用），其中的(?=ing)就是零宽度的，它本质代表一个位置。</li></ul><blockquote><p>占有字符是互斥的，零宽度是非互斥的。也就是一个字符，同一时间只能由一个子表达式匹配，而一个位置，却可以同时由多个零宽度的子表达式匹配。举个栗子，比如/aa/是匹配不了a的，这个字符串中的a只能由正则的第一个a字符匹配，而不能同时由第二个a匹配（废话）；但是位置是可以多个匹配的，比如/\b\ba/是可以匹配a的，虽然正则表达式里有2个表示单词开头位置的\b元字符，这两个\b是可以同时匹配位置0（在这个例子中）的</p></blockquote><h5 id="控制权和传动"><a href="#控制权和传动" class="headerlink" title="控制权和传动"></a>控制权和传动</h5><p>控制权是指哪一个正则子表达式（可能为一个普通字符、元字符或元字符序列组成）在匹配字符串，那么控制权就在哪。</p><p>传动是指正则引擎的一种机制，传动装置将定位正则从字符串的哪里开始匹配。</p><blockquote><p>正则表达式当开始匹配的时候，一般是由一个子表达式获取控制权，从字符串中的某一个位置开始尝试匹配，一个子表达式开始尝试匹配的位置，是从前一子表达匹配成功的结束位置开始的</p></blockquote><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p><img src="http://upload-images.jianshu.io/upload_images/2463524-62ea8063e4cf5821.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h4 id="要用某类常见字符——简单元字符"><a href="#要用某类常见字符——简单元字符" class="headerlink" title="要用某类常见字符——简单元字符"></a>要用某类常见字符——简单元字符</h4><ul><li>‘.’ 匹配除了换行符以外的任意字符，也即是[^\n]，如果要包含任意字符，可使用(.|\n)</li><li>\w (whatever) 匹配任意字母、数字或者下划线，等价于[a-zA-Z0-9_]，在deerchao的文中还指出可匹配汉字，但是\w在JS中是不能匹配汉字的</li><li>\s (space) 匹配任意空白符，包含换页符\f、换行符\n、回车符\r、水平制表符\t、垂直制表符\v</li><li>\d 匹配数字</li><li>\un (Unicode) 匹配n，这里的n是一个有4个十六进制数字表示的Unicode字符，比如\u597d表示中文字符“好”，那么超过\uffff编号的字符怎么表示呢？ES6的u修饰符会帮你。</li></ul><h4 id="要表示出现次数（重复）——限定符"><a href="#要表示出现次数（重复）——限定符" class="headerlink" title="要表示出现次数（重复）——限定符"></a>要表示出现次数（重复）——限定符</h4><ul><li>a*表示字符a连续出现次数 &gt;= 0 次</li><li>a+表示字符a连续出现次数 &gt;= 1 次</li><li>a?表示字符a出现次数 0 或 1 次</li><li>a{5}表示字符a连续出现次数 5 次</li><li>a{5,}表示字符a连续出现次数 &gt;= 5次</li><li>a{5,10}表示字符a连续出现次数为 5到10次 ，包括5和10</li></ul><h4 id="匹配位置——定位符和零宽断言"><a href="#匹配位置——定位符和零宽断言" class="headerlink" title="匹配位置——定位符和零宽断言"></a>匹配位置——定位符和零宽断言</h4><ul><li>\b 匹配单词边界位置，准确的描述是它匹配一个位置，这个位置前后不全是\w能描述的字符，所以像\u597d\babc是可以匹配“好abc”的。</li><li>^ 匹配字符串开始位置，也就是位置0，如果设置了 RegExp 对象的 Multiline 属性，^ 也匹配 ‘\n’ 或 ‘\r’ 之后的位置</li><li>$ 匹配字符串结束位置，如果设置了RegExp 对象的 Multiline 属性，$ 也匹配 ‘\n’ 或 ‘\r’ 之前的位置</li></ul><h4 id="想表达“或”的意思——字符簇和分歧"><a href="#想表达“或”的意思——字符簇和分歧" class="headerlink" title="想表达“或”的意思——字符簇和分歧"></a>想表达“或”的意思——字符簇和分歧</h4><blockquote><p>字符簇可用来表达字符级别的“或”语义，表示的是方括号中的字符任选一：</p></blockquote><ul><li>[abc]表示a、b、c这3个字符中的任意一个，如果字母或者数字是连续的，那么可以用-连起来表示，[b-f]代表从b到f这么多字符中任选一个</li><li>[(ab)(cd)]并不会用来匹配字符串“ab”或“cd”，而是匹配a、b、c、d、(、)这6个字符中的任一个，也就是想表达“匹配字符串ab或者cd”这样的需求不能这么做，要这么写ab|cd。但这里要匹配圆括号本身，讲道理是要反斜杠转义的，但是在方括号中，圆括号被当成普通字符看待，即便如此，仍然建议显式地转义</li><li>分歧用来表达表达式级别的“或”语义，表示的是匹配|左右任一表达就可：<br>ab|cd会匹配字符串“ab”或者“cd”</li><li>会短路，回想下编程语言中逻辑或的短路，所以用(ab|abc)去匹配字符串“abc”，结果会是“ab”，因为竖线左边的已经满足了，就用左边的匹配结果代表整个正则的结果</li></ul><h4 id="想表达“非”的意思——反义"><a href="#想表达“非”的意思——反义" class="headerlink" title="想表达“非”的意思——反义"></a>想表达“非”的意思——反义</h4><ul><li>\W、\D、\S、\B 用大写字母的这几个元字符表示就是对应小写字母匹配内容的反义，这几个依次匹配“除了字母、数字、下划线外的字符”、“非数字字符”、“非空白符”、“非单词边界位置”</li><li>[^aeiou]表示除了a、e、i、o、u外的任一字符，在方括号中且出现在开头位置的^表示排除，如果^在方括号中不出现在开头位置，那么它仅仅代表^字符本身</li></ul><h4 id="贪婪和非贪婪"><a href="#贪婪和非贪婪" class="headerlink" title="贪婪和非贪婪"></a>贪婪和非贪婪</h4><p>在限定符中，除了{n}确切表示重复几次，其余的都是一个有下限的范围。</p><p>在默认的模式（贪婪）下，会尽可能多的匹配内容。比如用ab*去匹配字符串“abbb”，结果是“abbb”。</p><p>而通过在限定符后面加问号?可以进行非贪婪匹配，会尽可能少地匹配。用ab*?去匹配“abbb”，结果会是“a”。</p><p>不带问号的限定符也称匹配优先量词，带问号的限定符也称忽略匹配优先量词。</p><h2 id="JS-中的正则"><a href="#JS-中的正则" class="headerlink" title="JS 中的正则"></a>JS 中的正则</h2><blockquote><p>字面量, 构造函数和工厂符号都是可以的：</p></blockquote><pre><code>/pattern/flags
new RegExp(pattern [, flags])
RegExp(pattern [, flags])
</code></pre><p>参数<br>pattern<br>正则表达式的文本。<br>flags<br>如果指定，标志可以具有以下值的任意组合：</p><ul><li><p>g 全局匹配;找到所有匹配，而不是在第一个匹配后停止</p></li><li><p>i 忽略大小写</p></li><li><p>m 多行; 将开始和结束字符（^和$）视为在多行上工作（例如，分别匹配每一行的开始和结束（由 \n 或 \r 分割），而不只是只匹配整个输入字符串的最开始和最末尾处。</p></li><li><p>u Unicode; 将模式视为Unicode序列点的序列</p></li><li><p>y 粘性匹配; 仅匹配目标字符串中此正则表达式的lastIndex属性指示的索引(并且不尝试从任何后续的索引匹配)。</p></li></ul><blockquote><p>有两种方法来创建一个RegExp对象：一是字面量、二是构造函数。要指示字符串，字面量的参数不使用引号，而构造函数的参数使用引号。因此，以下表达式创建相同的正则表达式</p></blockquote><pre><code>/ab+c/i;
new RegExp(&apos;ab+c&apos;, &apos;i&apos;);
new RegExp(/ab+c/, &apos;i&apos;);
</code></pre><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><blockquote><p>RegExp.prototype.exec()</p></blockquote><p>exec() 方法在一个指定字符串中执行一个搜索匹配。返回一个结果数组或 null。</p><pre><code>var matches = /h./.exec(&apos;This is a hello world!&apos;);
console.log(matches);        // [ &apos;hi&apos;, index: 1, input: &apos;This is a hello world!&apos; ]
</code></pre><blockquote><p>RegExp.prototype.test()</p></blockquote><p>test() 方法执行一个检索，用来查看正则表达式与指定的字符串是否匹配。返回 true 或 false。</p><p>当你想要知道一个模式是否存在于一个字符串中时，就可以使用 test()（类似于 String.prototype.search() 方法），差别在于test返回一个布尔值，而 search 返回索引（如果找到）或者-1（如果没找到）</p><pre><code>let str = &apos;hello world!&apos;;
let result = /hello/.test(str);
console.log(result);
// true
</code></pre><h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><blockquote><p>使用正则改变数据结构</p></blockquote><p>下例使用 replace 方法 （继承自 String）去匹配姓名 first last 输出新的格式 last, first。脚本中使用 $1 和 $2 指明括号里先前的匹配.</p><pre><code>var re = /(\w+)\s(\w+)/;
var str = &quot;John Smith&quot;;
var newstr = str.replace(re, &quot;$2, $1&quot;);
print(newstr);          //&quot;Smith, John&quot;
</code></pre><blockquote><p>在多行中使用正则表达式</p></blockquote><pre><code>var s = &quot;Please yes\nmake my day!&quot;;
s.match(/yes.*day/);
// Returns null
s.match(/yes[^]*day/);
// Returns &apos;yes\nmake my day&apos;
</code></pre><blockquote><p>使用正则表达式和 Unicode 字符</p></blockquote><p>\w 或 \W 只会匹配基本的 ASCII 字符；如 ‘a’ 到 ‘z’、 ‘A’ 到 ‘Z’、 0 到 9 及 ‘_’。为了匹配其他语言中的字符，如西里尔（Cyrillic）或 希伯来语（Hebrew），要使用 \uhhhh，”hhhh” 表示以十六进制表示的字符的 Unicode 值</p><pre><code>var text = &quot;Образец text на русском языке&quot;;
var regex = /[\u0400-\u04FF]+/g;

var match = regex.exec(text);
print(match[1]);  // prints &quot;Образец&quot;
print(regex.lastIndex);  // prints &quot;7&quot;

var match2 = regex.exec(text);
print(match2[1]);  // prints &quot;на&quot; [did not print &quot;text&quot;]
print(regex.lastIndex);  // prints &quot;15&quot;

// and so on
</code></pre><blockquote><p>从 URL 中提取子域名</p></blockquote><pre><code>var url = &quot;http://xxx.domain.com&quot;;
print(/[^.]+/.exec(url)[0].substr(7)); // prints &quot;xxx&quot;
</code></pre><div class="post-announce">Thank you for reading, this article belongs to <a href="http://yoursite.com">Hexo</a> copyright, if reproduced, please indicate the source：Hexo（<a href="http://yoursite.com/2018/03/13/正则表达式入门/">http://yoursite.com/2018/03/13/正则表达式入门/</a>）</div><div class="post__prevs"><div class="post__prev"><a href="/2018/03/13/dart 语法基础/" title="dart 语法基础"><i class="iconfont icon-prev"></i>dart 语法基础</a></div><div class="post__prev post__prev--right"><a href="/2018/03/13/redux/" title="redux your app">redux your app<i class="iconfont icon-next"></i></a></div></div></div></article></div><aside class="page__sidebar"><form id="page-search-from" class="page__search-from" action="/search/"><label class="search-form__item"><input class="input" type="text" name="search" placeholder="Search..."> <i class="iconfont icon-search"></i></label></form><div class="sidebar__block"><h3 class="block__title">Introduction</h3><p class="block__text">日常学习与兴趣交流的个人博客</p></div><div class="sidebar__block"><h3 class="block__title">Categories</h3></div><div class="sidebar__block"><h3 class="block__title">Latest Post</h3><ul class="block-list latest-post-list"><li class="latest-post-item"><a href="/2018/03/15/tcp_retransmission/" title="TCP 超时重传"><div class="item__cover"><img src="http://oo12ugek5.bkt.clouddn.com/images/default_cover.png" alt="TCP 超时重传"></div><div class="item__info"><h3 class="item__title">TCP 超时重传</h3><span class="item__text">2018-03-15</span></div></a></li><li class="latest-post-item"><a href="/2018/03/13/redux/" title="redux your app"><div class="item__cover"><img src="http://image.littlechao.top/20180204020725000005.jpg" alt="redux your app"></div><div class="item__info"><h3 class="item__title">redux your app</h3><span class="item__text">2018-03-13</span></div></a></li><li class="latest-post-item"><a href="/2018/03/13/正则表达式入门/" title="正则表达式入门"><div class="item__cover"><img src="https://tse3-mm.cn.bing.net/th?id=OIP.5HaX26pF6-WOmiKfHtTWkgHaEK&w=290&h=162&c=7&o=5&pid=1.7" alt="正则表达式入门"></div><div class="item__info"><h3 class="item__title">正则表达式入门</h3><span class="item__text">2018-03-13</span></div></a></li><li class="latest-post-item"><a href="/2018/03/13/dart 语法基础/" title="dart 语法基础"><div class="item__cover"><img src="http://image.littlechao.top/20180224115242000010.jpg" alt="dart 语法基础"></div><div class="item__info"><h3 class="item__title">dart 语法基础</h3><span class="item__text">2018-03-13</span></div></a></li></ul></div><div class="sidebar__block"><h3 class="block__title">Tags</h3><ul class="block-list tag-list clearfix"><li class="tag-item"><a class="tag-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-item"><a class="tag-link" href="/tags/dart/">dart</a></li><li class="tag-item"><a class="tag-link" href="/tags/golang/">golang</a></li><li class="tag-item"><a class="tag-link" href="/tags/net/">net</a></li><li class="tag-item"><a class="tag-link" href="/tags/react/">react</a></li><li class="tag-item"><a class="tag-link" href="/tags/redux/">redux</a></li><li class="tag-item"><a class="tag-link" href="/tags/regex/">regex</a></li><li class="tag-item"><a class="tag-link" href="/tags/tcp/">tcp</a></li></ul></div></aside></main><footer class="page__footer"><section class="footer__top"><div class="page__container footer__container"><div class="footer-top__item footer-top__item--2"><h3 class="item__title">About</h3><div class="item__content"><p class="item__text">本站是基于 Hexo 搭建的静态资源博客，主要用于分享日常学习、生活及工作的一些心得总结，欢迎点击右下角订阅 rss。</p><ul class="footer__contact-info"><li class="contact-info__item"><i class="iconfont icon-address"></i> <span>Baoding, Hebei Province, China</span></li><li class="contact-info__item"><i class="iconfont icon-email2"></i> <span>shichao1996@gmail.com</span></li></ul></div></div><div class="footer-top__item footer__image"><img src="http://oo12ugek5.bkt.clouddn.com/images/qrcode.png" alt="logo" title="Hexo"></div></div></section><section class="footer__bottom"><div class="page__container footer__container"><p class="footer__copyright">© <a href="https://github.com/Mrminfive/hexo-theme-skapp" target="_blank">Skapp</a> 2017 powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, made by <a href="https://github.com/Mrminfive" target="_blank">minfive</a>.</p><ul class="footer__social-network clearfix"></ul></div></section></footer><div id="back-top" class="back-top back-top--hidden js-hidden"><i class="iconfont icon-top"></i></div></div><script src="/js/common.js"></script><script src="/js/page/post.js"></script><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>